var app;app=angular.module("madacra",["madacra.identity"]);app.config(function($interpolateProvider,$routeProvider){$interpolateProvider.startSymbol("{+");return $interpolateProvider.endSymbol("+}");});app.controller("MainController",function($scope,identity){});var module,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i;}return-1;};module=angular.module("madacra.socketio",[]);module.factory("socket",function($rootScope){var SocketService;SocketService=(function(){SocketService.name='SocketService';function SocketService(){this.emit=__bind(this.emit,this);this.addEvents=__bind(this.addEvents,this);this.addEvent=__bind(this.addEvent,this);this.socket=io.connect();this.events=[];}
SocketService.prototype.broadcastOnRootScope=function(eventName){return function(){var args;args=1<=arguments.length?__slice.call(arguments,0):[];return $rootScope.$apply(function(){return $rootScope.$broadcast.apply($rootScope,[eventName].concat(__slice.call(args)));});};};SocketService.prototype.getNamespace=function(namespace){if((namespace!=null)&&namespace!==""){return this.socket.of(namespace);}else{return this.socket;}};SocketService.prototype.addEvent=function(namespace,eventName){var name;name=""+namespace+":"+eventName;if(__indexOf.call(this.events,name)<0){return this.getNamespace(namespace).on(eventName,this.broadcastOnRootScope(name));}};SocketService.prototype.addEvents=function(eventMap){var eventName,eventNames,namespace,_results;_results=[];for(namespace in eventMap){eventNames=eventMap[namespace];_results.push((function(){var _i,_len,_results1;_results1=[];for(_i=0,_len=eventNames.length;_i<_len;_i++){eventName=eventNames[_i];_results1.push(this.addEvent(namespace,eventName));}
return _results1;}).call(this));}
return _results;};SocketService.prototype.emit=function(namespace,eventName,data){return this.getNamespace(namespace).emit(eventName,data);};return SocketService;})();return new SocketService();});var module;module=angular.module("madacra.identity",["madacra.socketio"]);module.factory("identity",function($rootScope,socket){var IdentityService;IdentityService=(function(){IdentityService.name='IdentityService';function IdentityService(){var _this=this;this.token=null;socket.addEvents({"/identity":["changed"],"":["connect"]});$rootScope.$on("/identity:changed",function(event,data){return _this.token=data.token;});}
IdentityService.prototype.authenticate=function(username,password){return socket.emit("/identity","login",{username:username,password:password});};return IdentityService;})();return new IdentityService();});